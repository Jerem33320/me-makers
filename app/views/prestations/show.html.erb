<div class="container">
  <div style="box-shadow: 0 2px 4px 0 rgba(0,0,0,0.50); padding: 20px">
    <h1 style="text-align: center">Devis</h1>
    <div class="row">
      <span style="text-align: center;"><img alt="" style="max-height: 80px; max-width: 80px" src="http://www.jonathantneal.com/examples/invoice/logo.png"><input type="file" accept="image/*"></span>
      <div class="col-6" style="margin-top: 30px">
            <address contenteditable>
            <p><strong>Nom: </strong><%= @prestation.project.user.first_name %> <%= @prestation.project.user.last_name %></p>
            <p><strong>Adresse: </strong><%= @prestation.project.user.address %></p>
            <p><strong>Tél: </strong><%= @prestation.project.user.phone_number %></p>
            </address>
      </div>
      <div class="col-6" style="margin-top: 30px; text-align: right;">
            <address contenteditable>
              <p><%= @prestation.artisan.company %><br><%= @prestation.artisan.first_name %> <%= @prestation.artisan.last_name %></p>
            </address>
      </div>
  </div>


        <h1>Description</h1>
           <table class="meta" style="margin-bottom: 30px">
              <tr>
                <th><span contenteditable>Devis #</span></th>
                <td><span contenteditable><%= @prestation.id %></span></td>
              </tr>
              <tr>
                <th><span contenteditable>Date</span></th>
                <td><span contenteditable><%= @prestation.project.date %></span></td>
              </tr>
              <tr>
                <th><span contenteditable>Prix Total</span></th>
                <td><span id="prefix" contenteditable>€</span><span><%= @prestation.price %></span></td>
              </tr>
            </table>

            <table class="inventory">
              <thead>
                <tr>
                  <th><span contenteditable>Item</span></th>
                  <th><span contenteditable>Description</span></th>
                  <!-- <th><span contenteditable>Prix</span></th> -->
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><a class="cut">-</a><span contenteditable>Matériaux</span></td>
                  <td><span contenteditable><%= @prestation.material %></span></td>
                  <!-- <td><span contenteditable="">€</span><span></span></td> -->
                </tr>
                <tr>
                  <td><a class="cut">-</a><span contenteditable>Main d'oeuvre</span></td>
                  <td><span contenteditable><%= @prestation.workforce %></span></td>
                  <!-- <td><span data-prefix>€</span><span>600.00</span></td> -->
                </tr>
              </tbody>
            </table>
              <!-- <tr>
                <th><span contenteditable>Total</span></th>
                <td><span data-prefix>€</span><span>600.00</span></td>
              </tr> -->
  </div>
</div>

  <div class="container">
  <% if current_user.artisan %>
    <p><br><%= link_to "Editer le devis", edit_me_artisans_prestation_path(@prestation), class: 'btn btn-warning btn-block' %>
  <% else %>
       <%= link_to "Valider", projects_path, class: 'btn btn-light' %>
       <%= link_to "Rejeter", projects_path, class: 'btn btn-light' %>
    </p>
  <% end %>
  </div>

<!-- Sylvain -->

<!-- <div class="container">
  <h1 class="top-title">Votre devis</h1>

  <div class="text-center">
    <h6>avec</h6>
    <%# if current_user.artisan %>
      <h5><%= @prestation.project.user.first_name %> <%= @prestation.project.user.last_name %></h5>
    <%# else %>
      <h5><%= @prestation.artisan.first_name %> <%= @prestation.artisan.last_name %></h5>
      <h6><%= @prestation.artisan.specialty %></h6>
    <%# end %>
    <br>
    <h6><strong>Titre</strong></h6>
    <p>
      <%= @prestation.title %>
    </p>
    <h6><strong>Description</strong></h6>
    <p>
      <%= @prestation.description %>
    </p>
    <h6><strong>Date</strong></h6>
    <p>
      à partir du <%= @prestation.project.date.day %>/<%= @prestation.project.date.month %>/<%= @prestation.project.date.year %>
    </p>
    <h6><strong>Matériaux</strong></h6>
    <p>
      <%= @prestation.material %>
    </p>
    <h6><strong>Main d'oeuvre</strong></h6>
    <p>
      <%= @prestation.workforce %>
    </p>
    <h6><strong>Prix</strong></h6>
    <p>
      <%= @prestation.price %> €
    </p>
    <br>
    <%# if current_user.artisan %>
      <p>
        <%#= link_to "Editer le devis", edit_me_artisans_prestation_path(@prestation), class: 'btn btn-light' %>
        <%#= link_to "Retour", me_artisans_prestations_path, class: 'btn btn-light' %>
    <%# else %>
        <%#= link_to "Valider", '#', class: 'btn btn-light' %>
        <%#= link_to "Rejeter", '#', class: 'btn btn-light' %>
        <%#= link_to "Retour", projects_path, class: 'btn btn-light' %>
      </p>
    <%# end %>
  </div> -->

  <!-- Chat-room -->
  <div class="row">
    <div class="col-sm-12">
      <div class="chat-header"><h1 class="top-title" style="color: white !important">Messagerie</h1></div>
      <div class="messages">
        <% @prestation.messages.each do |message| %>
          <%= render "messages/message", message: message, user_is_messages_author: message.user == current_user %>
        <% end %>
      </div>
      <div class="create-message">
        <%= simple_form_for [@prestation, Message.new ], remote: true do |f| %>
          <%= f.input :content, label: false %>
        <% end %>
      </div>
    </div>
  </div>



<!-- Avis -->
<% content_for :after_js do %>
  <script>
    scrollLastMessageIntoView();
    App['prestation_<%= @prestation.id %>'] = App.cable.subscriptions.create(
      { channel: 'PrestationsChannel', prestation_id: <%= @prestation.id %> }, {
      connected: () => {
        console.log("[CONNECTED]")
      },
      received: (data) => {
        const messagesContainer = document.querySelector('.messages');
        messagesContainer.insertAdjacentHTML('beforeend', data.message_partial);
        if (data.author_id == <%= current_user.id %>) {
          document.getElementById(data.message_id).classList.add("right")
        }
        const input = document.querySelector('#message_content');
        input.value = '';
        scrollLastMessageIntoView();
        }
      }
    )
  </script>
<% end %>
  <% if current_user.artisan %>
    <%= link_to "RETOUR", me_artisans_prestations_path, class: 'btn btn-warning btn-block' %>
  <% else %>
    <%= link_to "Retour", projects_path, class: 'btn btn-warning btn-block' %>
  <% end %>
</div>



